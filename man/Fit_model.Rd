% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Fit_model.R
\name{Fit_model}
\alias{Fit_model}
\title{Fit and predict fish traits}
\usage{
Fit_model(
  N_factors,
  N_obsfactors,
  Use_REML = TRUE,
  Database = FishLife::FishBase_and_RAM,
  Y_ij = Database$Y_ij,
  Z_ik = Database$Z_ik,
  SR_obs = Database$SR_obs,
  StockData = Database$StockData,
  Version = "Taxon_v2_14_0",
  Process_cov = "Unequal",
  TmbDir = system.file("executables", package = "FishLife"),
  RunDir = tempfile(pattern = "run_", tmpdir = tempdir(), fileext = "/"),
  verbose = FALSE,
  debug_mode = FALSE,
  j_SR = ncol(Y_ij) - 3:1,
  zerocovTF_j = rep(FALSE, ncol(Y_ij)),
  additional_variance = c(0, 0),
  invertTF = FALSE,
  SD_b_stock = 10,
  b_type = 0,
  Cov_design = NULL,
  Cov_RAM = c(M = FALSE),
  Turn_off_taxonomy = FALSE,
  Pen_lowvar_lnRhat = 1,
  lowerbound_MLSPS = 1,
  Use_RAM_Mvalue_TF = TRUE,
  rho_space = "natural",
  n_sims = 1000,
  n_batches = NULL,
  include_r = TRUE,
  PredTF_stock = NULL,
  extract_covariance = TRUE,
  run_model = TRUE,
  Params = "Generate",
  Random = "Generate",
  Map = "Generate",
  ...
)
}
\arguments{
\item{N_factors}{Number of factors in decomposition of covariance for random-walk along evolutionary tree (0 means a diagonal but unequal covariance; negative is the sum of a factor decomposition and a diagonal-but-unequal covariance)}

\item{N_obsfactors}{Number of factors in decomposotion of observation covariance (same format as \code{N_obsfactors})}

\item{Use_REML, }{OPTIONAL boolean whether to use maximum marginal likelihood or restricted maximum likelihood (termed "REML")}

\item{Database, }{Whether to use results for both adult and stock-recruit parameters, \code{Database="FishBase_and_RAM"}, or just adult parameters, \code{Database="FishBase"}}

\item{Y_ij}{a data frame of trait values (perhaps log-scaled) with rows for records, and tagged-columns for traits}

\item{Z_ik}{a data frame of taxonomic classification for each row of \code{Y_ij}}

\item{SR_obs}{Stock-recruit records from RAM Legacy stock-recruit database}

\item{StockData}{Auxiliary information for every stock with stock-recruit information}

\item{Version}{TMB version number}

\item{Process_cov}{Whether process-error covariance is equal or differs multiplicatively for different taxonomic levels (Options:  "Equal" or "Unequal")}

\item{TmbDir}{Directory containing pre-compiled TMB script}

\item{RunDir}{Directory to use when compiling and running TMB script (different to avoid problems with read-write restrictions)}

\item{verbose}{Boolean whether to print diagnostics to terminal}

\item{run_model}{Boolean indicating whether to run the model or just return the built TMB object}

\item{Params}{optional list of parameter estimates to use as starting values (Default \code{Params="Generate"} starts from random values)}
}
\value{
Tagged list containing objects from FishLife run (first 9 slots constitute list 'Estimate_database' for archiving results)
\describe{
  \item{N_factors}{Number of factors used for evolution in life-history model}
  \item{N_obsfactors}{Number of factors used for measurent-error in life-history model}
  \item{Use_REML}{Boolean, whether REML was used for model}
  \item{Cov_gjj}{Covariance among traits for every taxon in tree}
  \item{ParentChild_gz}{Record of taxonomic tree}
  \item{ParHat}{Parameter estimates and predictions}
  \item{g_i}{Associates every observation with a level of the taxonomic tree}
  \item{Y_ij}{Raw data}
  \item{Z_ik}{Taxonomy for each datum}
  \item{Obj}{The built TMB object}
  \item{Opt}{Output from optimization}
  \item{Report}{tagged list of report-file from TMB}
  \item{ParHat_SE}{Estimated/predicted standard errors for fixed/random effects}
}
}
\description{
\code{Fit_model} estimates parameters and predicts values from a multivariate random-walk model for fish traits
}
